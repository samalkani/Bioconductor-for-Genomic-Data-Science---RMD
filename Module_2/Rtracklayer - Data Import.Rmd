---
title: "Rtracklayer - Data Import"
author: "Sasha Ajay Malkani"
date: "2025-10-18"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## 1. Installing Bioconductor package

```{r Installing Bioconductor package}
# if (!require("BiocManager", quietly = TRUE))
#   install.packages("BiocManager")
# BiocManager::install()

```

## 2. Installing rtracklayer and Rsamtools

```{r Installing rtracklayer and Rsamtools}
BiocManager::install(c("rtracklayer", "Rsamtools"), force = TRUE)
BiocManager::install(c("Biostrings", "IRanges"), update = TRUE, ask = FALSE)

```

## 3. Troubleshooting installing packages

```{r Troubleshooting installing packages}
BiocManager::valid()

```

## 4. Load R libraries

```{r Load R libraries}
library(rtracklayer)
library(AnnotationHub)
library(Rsamtools)

```

## 5. Help for Import function

```{r Help for Import function}
?import

```

## 6. Set-up the Annotation Hub

```{r Set-up the Annotation Hub}
ahub <- AnnotationHub()
ahub

```

## 7. Look at the R data class slot

```{r Look at the R data class slot}
table(ahub$rdataclass)

```

## 8. Look at a BIGWIG file on Annotation Hub

```{r Look at a BIGWIG file on Annotation Hub}
ahub.bw = subset(ahub, rdataclass == "BigWigFile" 
                 & species == "Homo sapiens")

```

## 9. Get the first dataset in this BIGWIG file

```{r Get the first dataset in this BIGWIG file}
bw = ahub.bw[[1]]

```

## 10. Let's look at BW

```{r Let us look at BW}
bw

```

## 11. Import the data into memory

```{r Import the data into memory}
import(bw)

```

## 12. Import (read in) part of the file into memory

```{r Import (read in) part of the file into memory}
gr.chr22 = import(bw, which=GRanges("chr22", ranges = IRanges(1, 10^8)))
gr.chr22

```

## 13. Import (read in) part of the file into memory and return it as a RLE (Run Length Encoded Vector)

```{r Import (read in) part of the file into memory and return it as a RLE}
rle.chr22 = import(bw, which=GRanges("chr22", ranges = IRanges(1, 10^8)), as = "Rle")
rle.chr22

```

## 14. Display only RLE for chromosome 22

```{r Display only RLE for chromosome 22}
rle.chr22$chr22

```

## 15. Looking at the lift over function 

But to use lift over you need a chain file Accessing a chain file on Annotation Hub

```{r 15. Looking at the lift over function}
ahub.chain = subset(ahub, rdataclass == "ChainFile")
ahub.chain

```

## 16. Subset further to only contain Human data

```{r Subset further to only contain Human data}
ahub.chain = subset(ahub.chain, species == "Homo sapiens")
ahub.chain

```

## 17. Lift over query for hg18 and hg19

```{r Lift over query for hg18 and hg19}
query(ahub.chain, c("hg18","hg19"))

```

## 18. If we want to convert hg19 into hg18

```{r If we want to convert hg19 into hg18}
chain = query(ahub.chain, c("hg18","hg19"))[[1]]

```

## 19. A set of GRanges

```{r A set of GRanges}
gr.chr22 = import(bw, which=GRanges("chr22", ranges = IRanges(1, 10^8)))
gr.chr22

```

## 20. Using the liftOver() function

```{r Using the liftOver() function}
gr.hg18 = liftOver(gr.chr22, chain)

```

## 21. What comes out of the liftOver function

```{r What comes out of the liftOver function}
class(gr.hg18)

```



